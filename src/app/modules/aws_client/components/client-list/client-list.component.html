<!--Main client list-->
<div class="card clients_main">
    <!--Filter Section-->
    <div class="filter_section row">
        <!--Add new item-->
        <div class="col-lg-3 add_new" appAccessLevelVerification SelectedModuleCode="CLIEN"
            SelectedModuleAccessCode="ClientList" SelectedFeatureAccessCode="CLILST" [IsTab]="false" ActionState="ADD">
            <button (click)="onClickClientModifications('NEW', 0)" pTooltip="Add new client" tooltipPosition="top">+ Add
                New Client</button>
        </div>
        <!--End of Add new item-->

        <!--Person type-->
        <div class="col-lg-3 filter_item">
            <label>Filter by : </label>
            <p-dropdown [options]="personTypes" [(ngModel)]="filter.Param1" (onChange)="onChangeFilter('DRP')" />
        </div>
        <!--End of Person type-->
        <!--Search by name-->
        <div class="col-lg-3 filter_item">
            <label>Client name : </label>
            <input type="text" [(ngModel)]="filter.SearchQuery" (change)="onChangeFilter('SEARCH')" placeholder="Search..." />
        </div>
        <!--End of Search by name-->

        <!--Items per page-->
        <div class="col-lg-3 filter_item">
            <label>Records Per Page : </label>
            <input type="number" min="1" pattern="^[1-9]\d*$"  [(ngModel)]="filter.RecordsPerPage" (change)="onChangeFilter('RPP')" />
        </div>
        <!--Items per page-->

    </div>
    <!--End of Filter Section-->

    <!--Client list table-->
    <p-table styleClass="p-datatable-striped" [value]="clientList" [tableStyle]="{'min-width': '50rem'}">
        <ng-template pTemplate="header" class="table_header">
            <tr class="table_header_row">
                <th class="text_align_left">No.</th>
                <th class="header_col created_details">Created By</th>

                <th class="header_col">Full Name</th>
                <th class="header_col">Contacts</th>
                <th class="header_col">Payment Term</th>
                <th class="header_col">Address</th>
                <th class="header_col">Notes</th>
                <th class="header_col">Account</th>
                <th class="header_col">Action</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-client let-rowIndex="rowIndex">
            <tr class="table_body">
                <td>{{(rowIndex+1)+(this.filter.CurrentPage == 1 ? 0 :
                                this.filter.RecordsPerPage*(this.filter.CurrentPage-1))}}</td>
                <td class="created_details">
                    <div [pTooltip]="client.CreatedBy" tooltipPosition="top">{{client.CreatedBy}}</div>
                    <div class="created_date_txt" [pTooltip]="client.CreatedDate | date : 'MMM d, y, h:mm:ss a'"
                        tooltipPosition="top">(on
                        {{client.CreatedDate | date : 'MMM d, y, h:mm:ss a'}})</div>
                </td>
                <td [pTooltip]="client.FullName" tooltipPosition="top">{{client.FullName}}</td>
                <td class="contact_details">
                    <div  *ngFor="let contact of client.Contacts"
                        >
                        <div *ngIf="contact.ContactDetails.length > 0">
                            {{contact.Name}}
                        </div>
                        <div class="contact_item" *ngFor="let contactDetails of contact.ContactDetails"
                            [style.display]="contactDetails.ContactValue.trim().length == 0 ? 'none' : ''">
                            <i class="fa fa-circle" aria-hidden="true"></i>
                            <span>{{contactDetails.ContactType.Name}}: </span><span [pTooltip]="contactDetails.ContactValue"
                                tooltipPosition="top">{{returnPhoneNumberWithBrackets(contactDetails)}}</span>
                        </div>
                        
                    </div>
                </td>
                <td [pTooltip]="client.PaymentTerm" tooltipPosition="top">{{client.PaymentTerm}}</td>
                <td [pTooltip]="client.BillingAddress" tooltipPosition="top">{{client.BillingAddress}}</td>
                <td [pTooltip]="client.FinancialNotes" tooltipPosition="top">{{client.FinancialNotes}}</td>
                <td [pTooltip]="client.ExpenseAccount" tooltipPosition="top">{{client.ExpenseAccount}}</td>
                <td class="action_button">
                    <button pTooltip="View" tooltipPosition="top" class="green_btn"
                        (click)="onClickClientModifications('VIEW', client.Id)" appAccessLevelVerification
                        SelectedModuleCode="CLIEN" SelectedModuleAccessCode="ClientList"
                        SelectedFeatureAccessCode="CLILST" [IsTab]="false" ActionState="VIEW"><i class="fa fa-eye"
                            aria-hidden="true"></i></button>
                    <button pTooltip="Edit" tooltipPosition="top" class="blue_btn"
                        (click)="onClickClientModifications('EDIT', client.Id)" appAccessLevelVerification
                        SelectedModuleCode="CLIEN" SelectedModuleAccessCode="ClientList"
                        SelectedFeatureAccessCode="CLILST" [IsTab]="false" ActionState="EDIT"><i class="fa fa-pencil"
                            aria-hidden="true"></i></button>
                    <button pTooltip="Delete" tooltipPosition="top" class="red_btn"
                        (click)="onRemoveCLientCustomer(client)" appAccessLevelVerification SelectedModuleCode="CLIEN"
                        SelectedModuleAccessCode="ClientList" SelectedFeatureAccessCode="CLILST" [IsTab]="false"
                        ActionState="DELETE"><i class="fa fa-trash" aria-hidden="true"></i></button>
                </td>
            </tr>
           
        </ng-template>
    </p-table>
    <!--End of Client list table-->
    <div *ngIf="clientList.length == 0">
        <div colspan="9" class="empty_content">
            There are no items matching this filter criteria.
        </div>
    </div>
    <!-- Pagination section -->
    <p-paginator class="paginator_sec" #modulePaginator
        *ngIf="clientList && clientList.length > 0 && clientList[0].TotalRecords > filter.RecordsPerPage"
        [ngClass]="(clientList && clientList.length > 0 && clientList[0].TotalRecords > 10)?'':'display_hide'"
        [rows]="filter.RecordsPerPage" (onPageChange)="onPageChange($event)"
        [totalRecords]="(clientList.length>0)? clientList[0].TotalRecords:0"></p-paginator>
    <!-- End of Pagination section -->

</div>
<!--End of Main client list-->